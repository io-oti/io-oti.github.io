import{_ as s,c as a,o as t,ak as l}from"./chunks/framework.C836Duf6.js";const y=JSON.parse('{"title":"Nginx","description":"","frontmatter":{"author":"Io_oTI","date":"2024-07-12T00:00:00.000Z","publish":true,"tag":"nginx","title":"Nginx"},"headers":[],"relativePath":"posts/nginx/nginx-guide.md","filePath":"posts/nginx/nginx-guide.md","lastUpdated":1745747014000}'),n={name:"posts/nginx/nginx-guide.md"};function h(k,i,p,e,c,r){return t(),a("div",null,[...i[0]||(i[0]=[l(`<h2 id="命令" tabindex="-1">命令 <a class="header-anchor" href="#命令" aria-label="Permalink to &quot;命令&quot;">​</a></h2><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes catppuccin-latte catppuccin-mocha vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#9CA0B0;--shiki-light-font-style:italic;--shiki-dark:#6C7086;--shiki-dark-font-style:italic;"># 查找配置文件</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#89B4FA;--shiki-dark-font-style:italic;">nginx</span><span style="--shiki-light:#40A02B;--shiki-dark:#A6E3A1;"> -t</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#9CA0B0;--shiki-light-font-style:italic;--shiki-dark:#6C7086;--shiki-dark-font-style:italic;"># 启动 Nginx</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#89B4FA;--shiki-dark-font-style:italic;">/usr/local/nginx/sbin/nginx</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#9CA0B0;--shiki-light-font-style:italic;--shiki-dark:#6C7086;--shiki-dark-font-style:italic;"># 重启 Nginx</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#89B4FA;--shiki-dark-font-style:italic;">/usr/local/nginx/sbin/nginx</span><span style="--shiki-light:#40A02B;--shiki-dark:#A6E3A1;"> -s</span><span style="--shiki-light:#40A02B;--shiki-dark:#A6E3A1;"> reload</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#9CA0B0;--shiki-light-font-style:italic;--shiki-dark:#6C7086;--shiki-dark-font-style:italic;"># 停止 Nginx</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#89B4FA;--shiki-dark-font-style:italic;">/usr/local/nginx/sbin/nginx</span><span style="--shiki-light:#40A02B;--shiki-dark:#A6E3A1;"> -s</span><span style="--shiki-light:#40A02B;--shiki-dark:#A6E3A1;"> stop</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#9CA0B0;--shiki-light-font-style:italic;--shiki-dark:#6C7086;--shiki-dark-font-style:italic;"># 验证 配置文件</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#89B4FA;--shiki-dark-font-style:italic;">/usr/local/nginx/sbin/nginx</span><span style="--shiki-light:#40A02B;--shiki-dark:#A6E3A1;"> -t</span><span style="--shiki-light:#40A02B;--shiki-dark:#A6E3A1;"> -c</span><span style="--shiki-light:#4C4F69;--shiki-dark:#CDD6F4;"> [path]</span></span></code></pre></div><h2 id="配置" tabindex="-1">配置 <a class="header-anchor" href="#配置" aria-label="Permalink to &quot;配置&quot;">​</a></h2><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes catppuccin-latte catppuccin-mocha vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#9CA0B0;--shiki-light-font-style:italic;--shiki-dark:#6C7086;--shiki-dark-font-style:italic;">#user root;</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#89B4FA;--shiki-dark-font-style:italic;">worker_processes</span><span style="--shiki-light:#FE640B;--shiki-dark:#FAB387;">  1</span><span style="--shiki-light:#7C7F93;--shiki-dark:#9399B2;">;</span><span style="--shiki-light:#9CA0B0;--shiki-light-font-style:italic;--shiki-dark:#6C7086;--shiki-dark-font-style:italic;">                          # work进程的数量</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#89B4FA;--shiki-dark-font-style:italic;">events</span><span style="--shiki-light:#40A02B;--shiki-dark:#A6E3A1;"> {</span><span style="--shiki-light:#9CA0B0;--shiki-light-font-style:italic;--shiki-dark:#6C7086;--shiki-dark-font-style:italic;">                                      # 事件区块的开始</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#89B4FA;--shiki-dark-font-style:italic;">  worker_connections</span><span style="--shiki-light:#FE640B;--shiki-dark:#FAB387;">  1024</span><span style="--shiki-light:#7C7F93;--shiki-dark:#9399B2;">;</span><span style="--shiki-light:#9CA0B0;--shiki-light-font-style:italic;--shiki-dark:#6C7086;--shiki-dark-font-style:italic;">                   # 每个work进程支持的最大连接数</span></span>
<span class="line"><span style="--shiki-light:#4C4F69;--shiki-dark:#CDD6F4;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#89B4FA;--shiki-dark-font-style:italic;">http</span><span style="--shiki-light:#40A02B;--shiki-dark:#A6E3A1;"> {</span><span style="--shiki-light:#9CA0B0;--shiki-light-font-style:italic;--shiki-dark:#6C7086;--shiki-dark-font-style:italic;">                                        # http区块的开始</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#89B4FA;--shiki-dark-font-style:italic;">  include</span><span style="--shiki-light:#40A02B;--shiki-dark:#A6E3A1;">       mime.types</span><span style="--shiki-light:#7C7F93;--shiki-dark:#9399B2;">;</span><span style="--shiki-light:#9CA0B0;--shiki-light-font-style:italic;--shiki-dark:#6C7086;--shiki-dark-font-style:italic;">                   # Nginx支持的媒体类型库文件</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#89B4FA;--shiki-dark-font-style:italic;">  default_type</span><span style="--shiki-light:#40A02B;--shiki-dark:#A6E3A1;">  application/octet-stream</span><span style="--shiki-light:#7C7F93;--shiki-dark:#9399B2;">;</span><span style="--shiki-light:#9CA0B0;--shiki-light-font-style:italic;--shiki-dark:#6C7086;--shiki-dark-font-style:italic;">     # 默认的媒体类型</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#89B4FA;--shiki-dark-font-style:italic;">  sendfile</span><span style="--shiki-light:#40A02B;--shiki-dark:#A6E3A1;">      on</span><span style="--shiki-light:#7C7F93;--shiki-dark:#9399B2;">;</span><span style="--shiki-light:#9CA0B0;--shiki-light-font-style:italic;--shiki-dark:#6C7086;--shiki-dark-font-style:italic;">                           # 开启高效传输模式</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#89B4FA;--shiki-dark-font-style:italic;">  server</span><span style="--shiki-light:#40A02B;--shiki-dark:#A6E3A1;"> {</span><span style="--shiki-light:#9CA0B0;--shiki-light-font-style:italic;--shiki-dark:#6C7086;--shiki-dark-font-style:italic;">                                    # 第一个server区块的开始</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#89B4FA;--shiki-dark-font-style:italic;">    listen</span><span style="--shiki-light:#FE640B;--shiki-dark:#FAB387;">     80</span><span style="--shiki-light:#7C7F93;--shiki-dark:#9399B2;">;</span><span style="--shiki-light:#9CA0B0;--shiki-light-font-style:italic;--shiki-dark:#6C7086;--shiki-dark-font-style:italic;">                            # 侦听端口</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#89B4FA;--shiki-dark-font-style:italic;">    server_name</span><span style="--shiki-light:#40A02B;--shiki-dark:#A6E3A1;">  localhost</span><span style="--shiki-light:#7C7F93;--shiki-dark:#9399B2;">;</span><span style="--shiki-light:#9CA0B0;--shiki-light-font-style:italic;--shiki-dark:#6C7086;--shiki-dark-font-style:italic;">                   # 提供服务的域名主机名</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#89B4FA;--shiki-dark-font-style:italic;">    access_log</span><span style="--shiki-light:#40A02B;--shiki-dark:#A6E3A1;">   /var/log/nginx/host.access.log</span><span style="--shiki-light:#40A02B;--shiki-dark:#A6E3A1;">  main</span><span style="--shiki-light:#7C7F93;--shiki-dark:#9399B2;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#89B4FA;--shiki-dark-font-style:italic;">    location</span><span style="--shiki-light:#40A02B;--shiki-dark:#A6E3A1;"> /</span><span style="--shiki-light:#40A02B;--shiki-dark:#A6E3A1;"> {</span><span style="--shiki-light:#9CA0B0;--shiki-light-font-style:italic;--shiki-dark:#6C7086;--shiki-dark-font-style:italic;">                              # 第一个location区块开始</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#89B4FA;--shiki-dark-font-style:italic;">      root</span><span style="--shiki-light:#40A02B;--shiki-dark:#A6E3A1;">   html</span><span style="--shiki-light:#7C7F93;--shiki-dark:#9399B2;">;</span><span style="--shiki-light:#9CA0B0;--shiki-light-font-style:italic;--shiki-dark:#6C7086;--shiki-dark-font-style:italic;">                            # 站点的根目录</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#89B4FA;--shiki-dark-font-style:italic;">      index</span><span style="--shiki-light:#40A02B;--shiki-dark:#A6E3A1;">  index.html</span><span style="--shiki-light:#40A02B;--shiki-dark:#A6E3A1;"> index.htm</span><span style="--shiki-light:#7C7F93;--shiki-dark:#9399B2;">;</span><span style="--shiki-light:#9CA0B0;--shiki-light-font-style:italic;--shiki-dark:#6C7086;--shiki-dark-font-style:italic;">            # 默认的首页文件</span></span>
<span class="line"><span style="--shiki-light:#4C4F69;--shiki-dark:#CDD6F4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#89B4FA;--shiki-dark-font-style:italic;">    location</span><span style="--shiki-light:#40A02B;--shiki-dark:#A6E3A1;"> /xyz</span><span style="--shiki-light:#40A02B;--shiki-dark:#A6E3A1;"> {</span><span style="--shiki-light:#9CA0B0;--shiki-light-font-style:italic;--shiki-dark:#6C7086;--shiki-dark-font-style:italic;">                           # 二级目录</span></span>
<span class="line"><span style="--shiki-light:#D20F39;--shiki-light-font-style:italic;--shiki-dark:#F38BA8;--shiki-dark-font-style:italic;">      alias</span><span style="--shiki-light:#40A02B;--shiki-dark:#A6E3A1;">   html/xyz/</span><span style="--shiki-light:#7C7F93;--shiki-dark:#9399B2;">;</span><span style="--shiki-light:#9CA0B0;--shiki-light-font-style:italic;--shiki-dark:#6C7086;--shiki-dark-font-style:italic;">                      # 站点的根目录</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#89B4FA;--shiki-dark-font-style:italic;">      index</span><span style="--shiki-light:#40A02B;--shiki-dark:#A6E3A1;">  index.html</span><span style="--shiki-light:#40A02B;--shiki-dark:#A6E3A1;"> index.htm</span><span style="--shiki-light:#7C7F93;--shiki-dark:#9399B2;">;</span><span style="--shiki-light:#9CA0B0;--shiki-light-font-style:italic;--shiki-dark:#6C7086;--shiki-dark-font-style:italic;">            # 默认的首页文件</span></span>
<span class="line"><span style="--shiki-light:#4C4F69;--shiki-dark:#CDD6F4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#89B4FA;--shiki-dark-font-style:italic;">    location</span><span style="--shiki-light:#40A02B;--shiki-dark:#A6E3A1;"> /api/</span><span style="--shiki-light:#40A02B;--shiki-dark:#A6E3A1;"> {</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#89B4FA;--shiki-dark-font-style:italic;">      proxy_pass</span><span style="--shiki-light:#179299;--shiki-dark:#94E2D5;">   &lt;</span><span style="--shiki-light:#40A02B;--shiki-dark:#A6E3A1;">http://</span><span style="--shiki-light:#4C4F69;--shiki-dark:#CDD6F4;">$</span><span style="--shiki-light:#179299;--shiki-dark:#94E2D5;">&gt;</span><span style="--shiki-light:#40A02B;--shiki-dark:#A6E3A1;">{API_SERVER}/</span><span style="--shiki-light:#7C7F93;--shiki-dark:#9399B2;">;</span><span style="--shiki-light:#9CA0B0;--shiki-light-font-style:italic;--shiki-dark:#6C7086;--shiki-dark-font-style:italic;">   # 后端服务代理</span></span>
<span class="line"><span style="--shiki-light:#4C4F69;--shiki-dark:#CDD6F4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#89B4FA;--shiki-dark-font-style:italic;">    error_page</span><span style="--shiki-light:#FE640B;--shiki-dark:#FAB387;">   404</span><span style="--shiki-light:#40A02B;--shiki-dark:#A6E3A1;"> /404.html</span><span style="--shiki-light:#7C7F93;--shiki-dark:#9399B2;">;</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#89B4FA;--shiki-dark-font-style:italic;">    location</span><span style="--shiki-light:#40A02B;--shiki-dark:#A6E3A1;"> =</span><span style="--shiki-light:#40A02B;--shiki-dark:#A6E3A1;"> /40x.html</span><span style="--shiki-light:#40A02B;--shiki-dark:#A6E3A1;"> {</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#89B4FA;--shiki-dark-font-style:italic;">        root</span><span style="--shiki-light:#40A02B;--shiki-dark:#A6E3A1;">   404.html</span></span>
<span class="line"><span style="--shiki-light:#4C4F69;--shiki-dark:#CDD6F4;">    }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#89B4FA;--shiki-dark-font-style:italic;">    error_page</span><span style="--shiki-light:#FE640B;--shiki-dark:#FAB387;">   500</span><span style="--shiki-light:#FE640B;--shiki-dark:#FAB387;"> 502</span><span style="--shiki-light:#FE640B;--shiki-dark:#FAB387;"> 503</span><span style="--shiki-light:#FE640B;--shiki-dark:#FAB387;"> 504</span><span style="--shiki-light:#40A02B;--shiki-dark:#A6E3A1;">  /50x.html</span><span style="--shiki-light:#7C7F93;--shiki-dark:#9399B2;">;</span><span style="--shiki-light:#9CA0B0;--shiki-light-font-style:italic;--shiki-dark:#6C7086;--shiki-dark-font-style:italic;">  # 出现对应的http状态码时，使用50x.html回应客户</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#89B4FA;--shiki-dark-font-style:italic;">    location</span><span style="--shiki-light:#40A02B;--shiki-dark:#A6E3A1;"> =</span><span style="--shiki-light:#40A02B;--shiki-dark:#A6E3A1;"> /50x.html</span><span style="--shiki-light:#40A02B;--shiki-dark:#A6E3A1;"> {</span><span style="--shiki-light:#9CA0B0;--shiki-light-font-style:italic;--shiki-dark:#6C7086;--shiki-dark-font-style:italic;">                    # location区块开始，访问50x.html</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#89B4FA;--shiki-dark-font-style:italic;">      root</span><span style="--shiki-light:#40A02B;--shiki-dark:#A6E3A1;">   html</span><span style="--shiki-light:#7C7F93;--shiki-dark:#9399B2;">;</span><span style="--shiki-light:#9CA0B0;--shiki-light-font-style:italic;--shiki-dark:#6C7086;--shiki-dark-font-style:italic;">                            # 指定对应的站点目录</span></span>
<span class="line"><span style="--shiki-light:#4C4F69;--shiki-dark:#CDD6F4;">    }</span></span>
<span class="line"><span style="--shiki-light:#4C4F69;--shiki-dark:#CDD6F4;">  }</span></span>
<span class="line"><span style="--shiki-light:#4C4F69;--shiki-dark:#CDD6F4;">}</span></span></code></pre></div><h3 id="开启-gzip" tabindex="-1">开启 gzip <a class="header-anchor" href="#开启-gzip" aria-label="Permalink to &quot;开启 gzip&quot;">​</a></h3><p><code>gzip</code> 是一种优秀的压缩算法，我们可以在 HTTP 请求上对一些文本文件，设置 <code>gzip</code> 压 缩。</p><p>服务端将响应头设置上 <code>Content-encoding: gzip</code>，表示当前资源会使用 <code>gzip</code> 压缩，提 示客户端解压使用。</p><p>当然前提是客户端支持该压缩算法，服务端会通过客户端发送的请求头中的 <code>Accept-Encoding</code> 字段来确定是否支持。</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes catppuccin-latte catppuccin-mocha vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#89B4FA;--shiki-dark-font-style:italic;">http</span><span style="--shiki-light:#40A02B;--shiki-dark:#A6E3A1;"> {</span></span>
<span class="line"><span style="--shiki-light:#9CA0B0;--shiki-light-font-style:italic;--shiki-dark:#6C7086;--shiki-dark-font-style:italic;">  # 开启 gzip 压缩</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#89B4FA;--shiki-dark-font-style:italic;">  gzip</span><span style="--shiki-light:#40A02B;--shiki-dark:#A6E3A1;">  on</span><span style="--shiki-light:#7C7F93;--shiki-dark:#9399B2;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#9CA0B0;--shiki-light-font-style:italic;--shiki-dark:#6C7086;--shiki-dark-font-style:italic;">  # 使用 gzip 压缩的文件类型，此外，text/html 是自带的，不用写上</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#89B4FA;--shiki-dark-font-style:italic;">  gzip_types</span><span style="--shiki-light:#40A02B;--shiki-dark:#A6E3A1;"> text/plain</span><span style="--shiki-light:#40A02B;--shiki-dark:#A6E3A1;"> text/css</span><span style="--shiki-light:#40A02B;--shiki-dark:#A6E3A1;"> application/javascript</span><span style="--shiki-light:#40A02B;--shiki-dark:#A6E3A1;"> application/json</span><span style="--shiki-light:#40A02B;--shiki-dark:#A6E3A1;"> text/xml</span><span style="--shiki-light:#40A02B;--shiki-dark:#A6E3A1;"> application/xml</span><span style="--shiki-light:#40A02B;--shiki-dark:#A6E3A1;"> application/xml+rss</span><span style="--shiki-light:#7C7F93;--shiki-dark:#9399B2;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#9CA0B0;--shiki-light-font-style:italic;--shiki-dark:#6C7086;--shiki-dark-font-style:italic;">  # 小于 256 字节的不压缩，这是因为压缩是需要时间的，太小的话压缩收益不大</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#89B4FA;--shiki-dark-font-style:italic;">  gzip_min_length</span><span style="--shiki-light:#FE640B;--shiki-dark:#FAB387;"> 256</span><span style="--shiki-light:#7C7F93;--shiki-dark:#9399B2;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#9CA0B0;--shiki-light-font-style:italic;--shiki-dark:#6C7086;--shiki-dark-font-style:italic;">  # 开启静态压缩，压缩的资源会被缓存下来，下次请求时就直接使用缓存</span></span>
<span class="line"><span style="--shiki-light:#1E66F5;--shiki-light-font-style:italic;--shiki-dark:#89B4FA;--shiki-dark-font-style:italic;">  gzip_static</span><span style="--shiki-light:#40A02B;--shiki-dark:#A6E3A1;">  on</span><span style="--shiki-light:#7C7F93;--shiki-dark:#9399B2;">;</span></span>
<span class="line"><span style="--shiki-light:#4C4F69;--shiki-dark:#CDD6F4;">}</span></span></code></pre></div><h2 id="参考" tabindex="-1">参考 <a class="header-anchor" href="#参考" aria-label="Permalink to &quot;参考&quot;">​</a></h2><ul><li><a href="https://www.notion.so/Nginx-0925a3f551934ddfb4c4d08a7e6fca60?pvs=21" target="_blank" rel="noreferrer">Nginx 使用指南</a></li></ul>`,11)])])}const g=s(n,[["render",h]]);export{y as __pageData,g as default};
